<div class="text-center justify-content-center">
  <div [formGroup]="form" class="questionBar container">
    <div class="row mb-2 justify-content-center">
      <div class="col-12-sm text-center">
        <h4>New Question</h4>
      </div>
    </div>
    <div class="row">
      <textarea [(ngModel)]="questionText"
        class="form-control input-form col-sm-12"
        placeholder="Ask a question!"
        formControlName="question"
        (keyup)="checkFormComplete()">
      </textarea>
      <div class="col-sm-12 line mt-2 mb-2"></div>
    </div>

    <div class="row" [ngClass]="{'hide-element': !topicMode}">
      <div class="input-group col-sm-12">
        <div class="input-group-prepend">
          <button class="iq-prepend dropdown-toggle" data-toggle="dropdown">{{ subjectDropdownText }}</button>
          <div class="dropdown-menu" style="border-radius: 9px;">
            <span class="dropdown-item" (click)="subjectDropdownText = 'Add Subject'">Add Subject</span>
            <span class="dropdown-item" (click)="subjectDropdownText = 'Create Subject'">Create Subject</span>
          </div>
        </div>
        <input #subjectField
          [(ngModel)]="topicText"
          class="form-control iq-form"
          formControlName="topic"
          placeholder="Enter subject name"
          (keyup)="subjectKeyup()"
          [typeahead]="subjectSearchResults"
          typeaheadOptionField="name"
          [typeaheadOptionsLimit]="5"
          [typeaheadMinLength]="3"
          (typeaheadOnSelect)="taSubjectSelected($event)">
      </div>
    </div>

    <div [ngClass]="{'hide-element': !topicMode}" class="add-subject-div row mb-3">
      <div class="col-sm-12">
        Can't find a subject? Try creating one!
      </div>
    </div>

    <div [ngClass]="{'hide-element': topicMode}" class="row">
      <div class="col-sm-12">
        <h4 [ngClass]="{'hide-element': !topicText?.length,
                        'section-title-animate': !topicMode,
                        'verified': selectedSubject.length,
                        'error': !selectedSubject.length}" class="sectionOpenTitle" (click)="topicModeOn()">{{ topicText }}</h4>
      </div>
    </div>

    <div class="row" [ngClass]="{'hide-element': !sourceMode}">
      <div class="input-group col-sm-12">
        <div class="input-group-prepend">
          <button class="iq-prepend dropdown-toggle" data-toggle="dropdown">{{ sourceDropdownText }}</button>
          <div class="dropdown-menu" style="border-radius: 9px;">
            <span class="dropdown-item" (click)="sourceDropdownText = 'Add Source'">Add Source</span>
            <span class="dropdown-item" (click)="sourceDropdownText = 'Create Source'">Create Source</span>
          </div>
        </div>
        <input #sourceField
          [ngClass]="{'hide-element': !sourceMode}"
          [(ngModel)]="sourceText"
          class="form-control iq-form col-sm-12"
          formControlName="source"
          placeholder="Enter source"
          (keyup)="sourceKeyup()"
          [typeahead]="sourceSearchResults"
          typeaheadOptionField="name"
          [typeaheadOptionsLimit]="5"
          [typeaheadMinLength]="3"
          (typeaheadOnSelect)="taSourceSelected($event)">
      </div>
    </div>

    <div [ngClass]="{'hide-element': !sourceMode}" class="add-subject-div text-center justify-content-center row mb-3">
      <div class="col-sm-12">
        Can't find your homework software/textbook? Don't forget to include an edition!
      </div>
    </div>

    <div [ngClass]="{'hide-element': sourceMode}" class="row">
      <div class="col-sm-12">
        <h4 [ngClass]="{'hide-element': !sourceText?.length,
                        'section-title-animate': !sourceMode,
                        'verified': selectedSource.length,
                        'error': !selectedSource.length}" class="sectionOpenTitle" (click)="sourceModeOn()">{{ sourceText }}</h4>
      </div>
    </div>

    <div class="row justify-content-center mt-2 mb-3">
      <div class="col-sm-4" (click)="topicModeToggle()">
        <div class="bubble" [ngClass]="{'bubble-selected': topicMode}">
          Add Subject
        </div>
      </div>
      <div class="col-sm-4" (click)="sourceModeToggle()">
        <div class="bubble" [ngClass]="{'bubble-selected': sourceMode}">
          Add Source
        </div>
      </div>
      <div class="col-sm-4">
        <div class="bubble">
          Add Tag
        </div>
      </div>
    </div>
  </div>

  <div style="position:relative;">
    <i class="fas fa-times fa-2x closeButton" (click)="close()"></i>
    <div>
      <button class="btn btn-secondary askButton" (click)="askQuestion()" [disabled]="!formComplete">
        Ask
      </button>
    </div>
  </div>
</div>
